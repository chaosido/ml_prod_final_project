groups:
- name: asr_qe_alerts
  rules:
  # 1. System Health: Is the API Crashing?
  - alert: HighErrorRate
    expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.05
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "High API Error Rate"
      description: "More than 5% of requests are failing (5xx) over the last 5 minutes."

  # 2. Model Health: Is the Model Predicting Drift?
  # I just run a heuristic: if > 50% of predictions have WER > 0.5 (very bad transcript)
  - alert: ModelDriftHighWER
    expr: rate(low_quality_transcripts_total[10m]) / rate(http_requests_total[10m]) > 0.5
    for: 10m
    labels:
      severity: warning
    annotations:
      summary: "Model Drift Detected"
      description: "More than 50% of recent audio is being flagged as Low Quality. Check input data source."
